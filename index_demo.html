<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="utf-8"/>
  <title>æ±å„„æ¯›å·¾æœ‰é™å…¬å¸ æ™ºæ…§èƒ½æ•ˆå„€è¡¨æ¿</title>
  <link href="style.css" rel="stylesheet"/>
  <style>
    body { font-family: "Segoe UI", sans-serif; background: #f7f7f7; margin: 0; padding: 2rem; color: #333; }
    .container { max-width: 1100px; margin: auto; background: #fff; padding: 2rem; border-radius: 12px; box-shadow: 0 0 10px rgba(0,0,0,0.08); }
    h1 { margin-bottom: 0.5rem; }
    h2 { margin-bottom: 0.2rem; }
    .section-title { margin-top: 2rem; }
    .device-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1rem; }
    .device { border: 1px solid #ddd; padding: 1rem; border-radius: 8px; background: #fafafa; }
    .device ul { padding-left: 1.2rem; }
    .device li span { font-weight: bold; color: #0077b6; }
    footer { text-align: center; font-size: 0.9rem; color: #888; margin-top: 3rem; }
    .logo { width: 140px; float: right; margin-top: -60px; }
  </style>
</head>
<body>
<div style="position:absolute; top:10px; right:30px; font-size:0.9rem; color:#444; background:#eef; padding:6px 12px; border-radius:6px;">
  ğŸ”„ é›»åŠ›æ’ç¢³ä¿‚æ•¸ï¼š0.474 kg COâ‚‚e/kWhï¼ˆæ›´æ–°æ—¥æœŸï¼š114/4/14ï¼‰
</div>
<div class="container">
  <div style="text-align:right; margin-bottom:1rem;">
    <button onclick="downloadCSV()" style="padding:6px 12px; font-size:0.9rem; background:#0077b6; color:white; border:none; border-radius:4px;">â¬‡ ä¸‹è¼‰æ™ºæ…§èƒ½æ•ˆ ESG æ—¥å ±è¡¨</button>
  </div>

  <h1>æ±å„„æ¯›å·¾æœ‰é™å…¬å¸ æ™ºæ…§èƒ½æ•ˆ Dashboard</h1>
  <p>ğŸ“ å®¢æˆ¶ç¾å ´ï¼š<strong>è™å°¾å» å€</strong>ï½œæ¯›å·¾è£½ç¨‹æ©Ÿå°ï¼š5 å°</p>
  <img alt="ATSAVE LOGO" class="logo" src="@SAVE.jpg"/>

  <div class="section-title"><h2>ğŸ“¦ æ©Ÿå°é‹ä½œèˆ‡ç¢³æ’æ¨¡æ“¬å€¼</h2></div>
  <div class="device-grid">
    <div class="device"><h3>ğŸ§µ æ¯›å·¾ç¹”æ©Ÿ</h3><p>AI èªå¥ï¼šè¨­å‚™è¡¨ç¾è‰¯å¥½ï¼Œç¶­æŒç¾æ³ã€‚</p><ul>
      <li>ç¨¼å‹•ç‡ï¼š<span>86%</span></li>
      <li>è‰¯ç‡ï¼š<span>99%</span></li>
      <li>é”æˆç‡ï¼š<span>95%</span></li>
      <li>å–®ä»¶è€—é›»ï¼š<span>111</span> Wh</li>
      <li>å–®ä»¶ç¢³æ’ï¼š<span>66</span> gCOâ‚‚</li>
    </ul></div>
    <div class="device"><h3>âœ‚ å‰–å¸ƒæ©Ÿ</h3><p>AI èªå¥ï¼šç¨¼å‹•ç‡åä½ï¼Œå»ºè­°æ’é™¤å¾…æ©Ÿç“¶é ¸ã€‚</p><ul>
      <li>ç¨¼å‹•ç‡ï¼š<span>66%</span></li>
      <li>è‰¯ç‡ï¼š<span>99%</span></li>
      <li>é”æˆç‡ï¼š<span>76%</span></li>
      <li>å–®ä»¶è€—é›»ï¼š<span>131</span> Wh</li>
      <li>å–®ä»¶ç¢³æ’ï¼š<span>63</span> gCOâ‚‚</li>
    </ul></div>
    <div class="device"><h3>ğŸª¡ è»Šé‚Šæ©Ÿ</h3><p>AI èªå¥ï¼šç¨¼å‹•ç‡åä½ï¼Œå»ºè­°æ’é™¤å¾…æ©Ÿç“¶é ¸ã€‚</p><ul>
      <li>ç¨¼å‹•ç‡ï¼š<span>68%</span></li>
      <li>è‰¯ç‡ï¼š<span>97%</span></li>
      <li>é”æˆç‡ï¼š<span>93%</span></li>
      <li>å–®ä»¶è€—é›»ï¼š<span>145</span> Wh</li>
      <li>å–®ä»¶ç¢³æ’ï¼š<span>56</span> gCOâ‚‚</li>
    </ul></div>
    <div class="device"><h3>ğŸ§¼ å‰ªé ­æ©Ÿ</h3><p>AI èªå¥ï¼šç¢³æ’åé«˜ï¼Œå»ºè­°å„ªåŒ–èƒ½è€—åƒæ•¸ã€‚</p><ul>
      <li>ç¨¼å‹•ç‡ï¼š<span>82%</span></li>
      <li>è‰¯ç‡ï¼š<span>96%</span></li>
      <li>é”æˆç‡ï¼š<span>94%</span></li>
      <li>å–®ä»¶è€—é›»ï¼š<span>115</span> Wh</li>
      <li>å–®ä»¶ç¢³æ’ï¼š<span>84</span> gCOâ‚‚</li>
    </ul></div>
    <div class="device"><h3>ğŸ“ æ‘ºé ­æ©Ÿ</h3><p>AI èªå¥ï¼šç¢³æ’åé«˜ï¼Œå»ºè­°å„ªåŒ–èƒ½è€—åƒæ•¸ã€‚</p><ul>
      <li>ç¨¼å‹•ç‡ï¼š<span>84%</span></li>
      <li>è‰¯ç‡ï¼š<span>97%</span></li>
      <li>é”æˆç‡ï¼š<span>78%</span></li>
      <li>å–®ä»¶è€—é›»ï¼š<span>123</span> Wh</li>
      <li>å–®ä»¶ç¢³æ’ï¼š<span>80</span> gCOâ‚‚</li>
    </ul></div>
  </div>

  <div class="section-title"><h2>ğŸ“Š ç¸½æ’ç¢³çµ±è¨ˆ</h2></div>
  <ul>
    <li>ç¸½ç¢³æ’é‡ï¼ˆæ¯æ—¥ï¼‰ï¼š<strong>14,500 gCOâ‚‚</strong></li>
    <li>ç¸½èƒ½è€—ï¼ˆæ¯æ—¥ï¼‰ï¼š<strong>29,800 Wh</strong></li>
    <li><span id="carbon-summary">æ¯ä»¶ç”¢å“ç¸½ç¢³æ’é‡ï¼ˆäº”æ©Ÿå°ç´¯åŠ ï¼‰ï¼š288 gCOâ‚‚ â†’ æ¨¡æ“¬å€¼ï¼š349 gCOâ‚‚</span></li>
  </ul>

  <footer>Powered by <strong>@SAVE æ™ºæ…§èƒ½æ•ˆç®¡ç†ç³»çµ±</strong></footer>
  <p style="color:#007700; font-weight:bold; margin-top:0.5rem;">AIå»ºè­°ï¼šç›®å‰ç¢³æ’æ°´æº–åˆç†ï¼Œå»ºè­°ç¶­æŒç¾æœ‰ç¯€èƒ½åƒæ•¸ã€‚</p>
</div>
<script>
function randomInt(min, max) {
  return Math.floor(Math.random() * (max - min + 1) + min);
}

function updateDashboard() {
  const devices = document.querySelectorAll(".device");
  let totalCarbon = 0;

  devices.forEach(device => {
    const kpis = device.querySelectorAll("li span");
    const ai = device.querySelector("p");

    const utilization = randomInt(60, 95);
    const quality = randomInt(92, 100);
    const achieve = randomInt(70, 100);
    const power = randomInt(100, 140);
    const carbon = Math.round(power * 0.474);

    kpis[0].innerText = utilization + "%";
    kpis[1].innerText = quality + "%";
    kpis[2].innerText = achieve + "%";
    kpis[3].innerText = power;
    kpis[4].innerText = carbon;

    totalCarbon += carbon;

    if (utilization < 70 || achieve < 75) {
      ai.innerText = "ç¨¼å‹•ç‡åä½ï¼Œå»ºè­°æ’é™¤å¾…æ©Ÿç“¶é ¸ã€‚";
    } else if (carbon > 75) {
      ai.innerText = "ç¢³æ’åé«˜ï¼Œå»ºè­°å„ªåŒ–èƒ½è€—åƒæ•¸ã€‚";
    } else {
      ai.innerText = "è¨­å‚™è¡¨ç¾è‰¯å¥½ï¼Œç¶­æŒç¾æ³ã€‚";
    }
  });

  const summary = document.getElementById("carbon-summary");
  summary.innerHTML = "æ¯ä»¶ç”¢å“ç¸½ç¢³æ’é‡ï¼ˆäº”æ©Ÿå°ç´¯åŠ ï¼‰ï¼š288 gCOâ‚‚ â†’ æ¨¡æ“¬å€¼ï¼š<strong>" + totalCarbon + "</strong> gCOâ‚‚";

  const tip = document.querySelector("p[style*='color']");
  tip.innerText = totalCarbon > 375
    ? "AIå»ºè­°ï¼šç¢³æ’åé«˜ï¼Œå»ºè­°æª¢æŸ¥é«˜èƒ½è€—å·¥åºä¸¦èª¿æ•´åƒæ•¸ã€‚"
    : totalCarbon > 320
    ? "AIå»ºè­°ï¼šç¢³æ’é‡ç•¥é«˜ï¼Œå¯è©•ä¼°ç¶­è­·é€±æœŸèˆ‡åŠŸç‡è¨­å®šã€‚"
    : "AIå»ºè­°ï¼šç›®å‰ç¢³æ’æ°´æº–åˆç†ï¼Œå»ºè­°ç¶­æŒç¾æœ‰ç¯€èƒ½åƒæ•¸ã€‚";
}

updateDashboard();
setInterval(updateDashboard, 60000);

function downloadCSV() {
  const headers = ["æ™‚æ®µ", "æ©Ÿå°", "ç¨¼å‹•ç‡(%)", "é”æˆç‡(%)", "è‰¯ç‡(%)", "ç”¢é‡", "å–®ä½èƒ½è€—(Wh)", "å–®ä½ç¢³æ’(gCOâ‚‚)"];
  const now = new Date();
  const hour = now.getHours();
  let csv = headers.join(",") + "\n";

  const devices = document.querySelectorAll(".device");
  devices.forEach((device, i) => {
    const name = device.querySelector("h3").innerText;
    const kpis = device.querySelectorAll("li span");
    const utilization = kpis[0].innerText;
    const quality = kpis[1].innerText;
    const achieve = kpis[2].innerText;
    const power = kpis[3].innerText;
    const carbon = kpis[4].innerText;
    const row = [`${hour}:00-${hour+1}:00`, name, utilization, achieve, quality, 1, power, carbon];
    csv += row.join(",") + "\n";
  });

  const blob = new Blob([csv], { type: "text/csv" });
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "æ™ºæ…§èƒ½æ•ˆESG_æ—¥å ±.csv";
  link.click();
}
</script>
</body>
</html>
